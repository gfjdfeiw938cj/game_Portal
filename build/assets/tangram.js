import"./modulepreload-polyfill.js";function e(e,t={}){let n=document.createElementNS(`http://www.w3.org/2000/svg`,e);for(let[e,r]of Object.entries(t))n.setAttribute(e,r);return n}function t(t,n,r){return e(`polygon`,{id:t,class:`tangram-piece big-triangle`,points:`0,0 50,0 0,50`,fill:`#2F4F2F`,stroke:`#283A28`,"stroke-width":`1`,"stroke-linejoin":`round`,"data-shape":`big-triangle`,transform:`translate(${n}, ${r})`})}function n(t,n,r){return e(`polygon`,{id:t,class:`tangram-piece big-triangle`,points:`0,0 0,50 50,0`,fill:`#556B2F`,stroke:`#445522`,"stroke-width":`1`,"stroke-linejoin":`round`,"data-shape":`big-triangle`,transform:`translate(${n}, ${r})`})}function r(t,n,r){return e(`polygon`,{id:t,class:`tangram-piece medium-triangle`,points:`0,0 35.355,0 0,35.355`,fill:`#6B8E23`,stroke:`#5A7720`,"stroke-width":`1`,"stroke-linejoin":`round`,"data-shape":`medium-triangle`,transform:`translate(${n}, ${r})`})}function i(t,n,r){return e(`polygon`,{id:t,class:`tangram-piece small-triangle`,points:`0,0 25,0 0,25`,fill:`#808000`,stroke:`#6A6A00`,"stroke-width":`1`,"stroke-linejoin":`round`,"data-shape":`small-triangle`,transform:`translate(${n}, ${r})`})}function a(t,n,r){return e(`polygon`,{id:t,class:`tangram-piece small-triangle`,points:`0,0 0,25 25,0`,fill:`#9ACD32`,stroke:`#82B029`,"stroke-width":`1`,"stroke-linejoin":`round`,"data-shape":`small-triangle`,transform:`translate(${n}, ${r})`})}function o(t,n,r){return e(`polygon`,{id:t,class:`tangram-piece square`,points:`0,0 25,0 25,25 0,25`,fill:`#8A9A5B`,stroke:`#78854A`,"stroke-width":`1`,"stroke-linejoin":`round`,"data-shape":`square`,transform:`translate(${n}, ${r})`})}function s(t,n,r){let i=35.355,a=17.6775,o=17.6775;return e(`polygon`,{id:t,class:`tangram-piece parallelogram`,points:`0,0 0,${i} ${a},${i+o} ${a},${o}`,fill:`#B8C4A3`,stroke:`#A0AD8E`,"stroke-width":`1`,"stroke-linejoin":`round`,"data-shape":`parallelogram`,transform:`translate(${n}, ${r})`})}document.addEventListener(`DOMContentLoaded`,function(){let e=document.getElementById(`game-board`);[{type:`bigTriangle1`,pos:{x:10,y:10}},{type:`bigTriangle2`,pos:{x:70,y:10}},{type:`mediumTriangle`,pos:{x:10,y:70}},{type:`smallTriangle1`,pos:{x:100,y:70}},{type:`smallTriangle2`,pos:{x:140,y:70}},{type:`square`,pos:{x:10,y:120}},{type:`parallelogram`,pos:{x:70,y:120}}].forEach((c,l)=>{let u;switch(c.type){case`bigTriangle1`:u=t(`piece-${l}`,c.pos.x,c.pos.y);break;case`bigTriangle2`:u=n(`piece-${l}`,c.pos.x,c.pos.y);break;case`mediumTriangle`:u=r(`piece-${l}`,c.pos.x,c.pos.y);break;case`smallTriangle1`:u=i(`piece-${l}`,c.pos.x,c.pos.y);break;case`smallTriangle2`:u=a(`piece-${l}`,c.pos.x,c.pos.y);break;case`square`:u=o(`piece-${l}`,c.pos.x,c.pos.y);break;case`parallelogram`:u=s(`piece-${l}`,c.pos.x,c.pos.y);break}u&&e.appendChild(u)})});var c={square:{name:`square`,pieces:[{type:`big-triangle`,transform:`translate(98.79999732971191, 100.40000534057617) rotate(135)`,x:98.8,y:100.4,angle:135,points:`0,0 50,0 0,50`,fill:`#2F4F2F`,stroke:`#283A28`},{type:`big-triangle`,transform:`translate(99.60000610351562, 99.60000610351562) rotate(225)`,x:99.6,y:99.6,angle:225,points:`0,0 0,50 50,0`,fill:`#556B2F`,stroke:`#445522`},{type:`medium-triangle`,transform:`translate(135.84499740600586, 136.80000686645508) rotate(180)`,x:135.84,y:136.8,angle:180,points:`0,0 35.355,0 0,35.355`,fill:`#6B8E23`,stroke:`#5A7720`},{type:`small-triangle`,transform:`translate(99.20000457763672, 101.59998321533203) rotate(45)`,x:99.2,y:101.6,angle:45,points:`0,0 25,0 0,25`,fill:`#808000`,stroke:`#6A6A00`},{type:`small-triangle`,transform:`translate(118, 83.20000457763672) rotate(315)`,x:118,y:83.2,angle:315,points:`0,0 0,25 25,0`,fill:`#9ACD32`,stroke:`#82B029`},{type:`square`,transform:`translate(117.59999465942383, 83.19999694824219) rotate(45)`,x:117.6,y:83.2,angle:45,points:`0,0 25,0 25,25 0,25`,fill:`#8A9A5B`,stroke:`#78854A`},{type:`parallelogram`,transform:`translate(116.40000534057617, 119.59999084472656) rotate(90)`,x:116.4,y:119.6,angle:90,points:`0,0 0,35.355 17.6775,53.0325 17.6775,17.6775`,fill:`#B8C4A3`,stroke:`#A0AD8E`}]},fox:{name:`fox`,pieces:[{type:`big-triangle`,transform:`translate(74.40000534057617, 150) rotate(270)`,x:74.4,y:150,angle:270,points:`0,0 50,0 0,50`,fill:`#2F4F2F`,stroke:`#283A28`},{type:`big-triangle`,transform:`translate(75.20000839233398, 99.99999237060547) rotate(315)`,x:75.2,y:100,angle:315,points:`0,0 0,50 50,0`,fill:`#556B2F`,stroke:`#445522`},{type:`medium-triangle`,transform:`translate(136.2450065612793, 83.59999752044678) rotate(135)`,x:136.25,y:83.6,angle:135,points:`0,0 35.355,0 0,35.355`,fill:`#6B8E23`,stroke:`#5A7720`},{type:`small-triangle`,transform:`translate(130.59999084472656, 38.400001525878906) rotate(315)`,x:130.6,y:38.4,angle:315,points:`0,0 25,0 0,25`,fill:`#808000`,stroke:`#6A6A00`},{type:`small-triangle`,transform:`translate(128.8000030517578, 39.20000076293945) rotate(135)`,x:128.8,y:39.2,angle:135,points:`0,0 0,25 25,0`,fill:`#9ACD32`,stroke:`#82B029`},{type:`square`,transform:`translate(129.2000093460083, 39.60000228881836) rotate(45)`,x:129.2,y:39.6,angle:45,points:`0,0 25,0 25,25 0,25`,fill:`#8A9A5B`,stroke:`#78854A`},{type:`parallelogram`,transform:`translate(135.9224910736084, 84.4000015258789) rotate(45)`,x:135.92,y:84.4,angle:45,points:`0,0 0,35.355 17.6775,53.0325 17.6775,17.6775`,fill:`#B8C4A3`,stroke:`#A0AD8E`}]}},l=`square`;function u(){return c[l]}function d(e){return c[e]?(l=e,!0):!1}function f(){let e=u();if(!e)return;let t=document.getElementById(`game-board`),n=document.getElementById(`tangram-hint`);n&&n.remove();let r=document.getElementById(`target-shape`);r&&r.remove();let i=document.getElementById(`target-outline`);i&&i.remove();let a=document.createElementNS(`http://www.w3.org/2000/svg`,`g`);a.id=`tangram-hint`,a.setAttribute(`class`,`tangram-hint`),e.pieces.forEach(e=>{let t=document.createElementNS(`http://www.w3.org/2000/svg`,`polygon`);t.setAttribute(`points`,e.points),t.setAttribute(`transform`,e.transform),t.setAttribute(`fill`,e.fill),t.setAttribute(`stroke`,e.stroke),t.setAttribute(`stroke-width`,`1`),t.setAttribute(`stroke-dasharray`,`2,2`),t.setAttribute(`opacity`,`0.25`),t.setAttribute(`pointer-events`,`none`),a.appendChild(t)}),t.appendChild(a)}function p(){let e=document.getElementById(`tangram-hint`);e&&e.remove()}var m=null,h=null;function g(){let e=document.querySelectorAll(`.tangram-piece`);if(!document.getElementById(`game-board`)||e.length===0){setTimeout(g,500);return}_(),b()}function _(){let e=document.getElementById(`game-board`),t=document.getElementById(`debug-overlay`);t&&t.remove(),m=document.createElementNS(`http://www.w3.org/2000/svg`,`g`),m.id=`debug-overlay`;let n=`rgba(200, 200, 200, 0.15)`;for(let e=0;e<=200;e+=25){let t=document.createElementNS(`http://www.w3.org/2000/svg`,`line`);t.setAttribute(`x1`,e.toString()),t.setAttribute(`y1`,`0`),t.setAttribute(`x2`,e.toString()),t.setAttribute(`y2`,`200`),t.setAttribute(`stroke`,n),t.setAttribute(`stroke-width`,`0.5`),m.appendChild(t)}for(let e=0;e<=200;e+=25){let t=document.createElementNS(`http://www.w3.org/2000/svg`,`line`);t.setAttribute(`x1`,`0`),t.setAttribute(`y1`,e.toString()),t.setAttribute(`x2`,`200`),t.setAttribute(`y2`,e.toString()),t.setAttribute(`stroke`,n),t.setAttribute(`stroke-width`,`0.5`),m.appendChild(t)}let r=document.getElementById(`target-outline`);r&&r.remove();let i=document.getElementById(`target-shape`);i&&i.remove(),e.insertBefore(m,e.firstChild)}function v(){let e=document.querySelectorAll(`.tangram-piece`),t=prompt(`Введите название фигуры:`,`new_shape`);if(!t)return null;let n={name:t,pieces:[]};return e.forEach(e=>{let t=e.getAttribute(`transform`)||`translate(0,0)`,r=0,i=0,a=0,o=t.match(/translate\(([^,]+),\s*([^)]+)\)/);o&&(r=parseFloat(o[1]),i=parseFloat(o[2]));let s=t.match(/rotate\(([^,)]+)/);s&&(a=parseFloat(s[1])),n.pieces.push({type:e.dataset.shape,transform:t,x:Math.round(r*100)/100,y:Math.round(i*100)/100,angle:Math.round(a*100)/100,points:e.getAttribute(`points`),fill:e.getAttribute(`fill`),stroke:e.getAttribute(`stroke`)})}),n}function y(){let e=v();if(!e)return;let t=JSON.stringify(e,null,2),n=document.createElement(`textarea`);n.value=t,n.style.position=`fixed`,n.style.left=`-999999px`,n.style.top=`-999999px`,document.body.appendChild(n),n.focus(),n.select();try{document.execCommand(`copy`),document.body.removeChild(n)}catch{document.body.removeChild(n)}}function b(){if(h){h.style.display=`block`;return}h=document.createElement(`div`),h.id=`debug-container`,h.style.cssText=`
        position: fixed;
        top: 10px;
        right: 10px;
        background: white;
        padding: 12px;
        border-radius: 4px;
        border: 1px solid #ccc;
        z-index: 10000;
        font-family: monospace;
        font-size: 12px;
        min-width: 180px;
    `,h.innerHTML=`
        <div style="margin-bottom: 8px; font-weight: bold; font-size: 14px; padding-bottom: 5px;">
            Инструмент создания фигур
        </div>
        <button id="debug-silhouette-btn" style="margin: 3px; padding: 6px 10px; background: #4a6fa5; color: white; border: none; border-radius: 4px; cursor: pointer; width: 100%;">
            Сохранить силуэт
        </button>
        <div style="margin-top: 8px; font-size: 10px; color: #666; padding-top: 5px;">
            • Расставьте фигуры<br>
            • Нажмите "Сохранить силуэт"<br>
            • Введите название<br>
            • Нажмите "ОК", чтобы добавить данные в буфер обмена
        </div>
    `,document.body.appendChild(h);let e=document.getElementById(`debug-silhouette-btn`);e&&e.addEventListener(`click`,y)}var x=`game`,S=document.querySelectorAll(`.game-mode-elements, .shape-selector`),C=document.querySelectorAll(`.game-instructions.creation-mode`);function w(){let e=document.getElementById(`mode-toggle`);e&&(E(`game`),e.addEventListener(`click`,T))}function T(){E(x===`game`?`creation`:`game`)}function E(e){x=e;let t=document.getElementById(`mode-toggle`);t&&(e===`creation`?(t.textContent=`Режим игры`,D()):(t.textContent=`Режим создания`,O())),e===`creation`?(S.forEach(e=>e.classList.add(`hidden`)),C.forEach(e=>e.classList.remove(`hidden`)),k(),typeof p==`function`&&p()):(S.forEach(e=>e.classList.remove(`hidden`)),C.forEach(e=>e.classList.add(`hidden`)),A())}function D(){let e=document.getElementById(`debug-container`);if(!e&&typeof g==`function`)g();else if(e){e.style.display=`block`;let t=document.getElementById(`debug-overlay`);t&&(t.style.display=`block`)}}function O(){let e=document.getElementById(`debug-container`);e&&(e.style.display=`none`);let t=document.getElementById(`debug-overlay`);t&&(t.style.display=`none`)}function k(){let e=document.getElementById(`check-btn`);e&&(e.disabled=!0,e.style.opacity=`0.5`,e.style.cursor=`not-allowed`)}function A(){let e=document.getElementById(`check-btn`);e&&(e.disabled=!1,e.style.opacity=`1`,e.style.cursor=`pointer`)}function j(){return x}document.addEventListener(`DOMContentLoaded`,function(){setTimeout(w,100)}),document.addEventListener(`DOMContentLoaded`,function(){setTimeout(e,100);function e(){let e=document.querySelectorAll(`.tangram-piece`),n=document.getElementById(`game-board`);if(!n||e.length===0)return;let r=n.createSVGPoint(),i=null,a=0,o=0,s=null;e.forEach(e=>{e.addEventListener(`mousedown`,t=>{t.button===0&&(t.preventDefault(),c(t,e))}),e.addEventListener(`contextmenu`,t=>{t.preventDefault(),d(e)}),e.addEventListener(`touchstart`,t=>{t.touches.length===1&&(t.preventDefault(),c(t.touches[0],e))},{passive:!1})});function c(e,t){i=t,s=t.getAttribute(`transform`)||`translate(0, 0)`,r.x=e.clientX,r.y=e.clientY;let c=r.matrixTransform(n.getScreenCTM().inverse());a=c.x,o=c.y;let d=s.match(/translate\(([^,]+),\s*([^)]+)\)/),f=0,m=0;d&&(f=parseFloat(d[1]),m=parseFloat(d[2])),a-=f,o-=m,t.classList.add(`dragging`),document.addEventListener(`mousemove`,l),document.addEventListener(`mouseup`,p),document.addEventListener(`touchmove`,u,{passive:!1}),document.addEventListener(`touchend`,p)}function l(e){if(!i)return;r.x=e.clientX,r.y=e.clientY;let t=r.matrixTransform(n.getScreenCTM().inverse()),s=t.x-a,c=t.y-o,l=i.getBBox(),u={left:0-l.x,right:200-(l.x+l.width),top:0-l.y,bottom:200-(l.y+l.height)};s=Math.max(u.left,Math.min(u.right,s)),c=Math.max(u.top,Math.min(u.bottom,c));let d=i.getAttribute(`transform`),f=``,p=d.match(/(rotate\([^)]+\))/);p&&(f=` `+p[1]),i.setAttribute(`transform`,`translate(${s}, ${c})${f}`)}function u(e){if(!i||e.touches.length!==1)return;e.preventDefault();let t=e.touches[0];r.x=t.clientX,r.y=t.clientY;let s=r.matrixTransform(n.getScreenCTM().inverse()),c=s.x-a,l=s.y-o,u=i.getBBox(),d={left:0-u.x,right:200-(u.x+u.width),top:0-u.y,bottom:200-(u.y+u.height)};c=Math.max(d.left,Math.min(d.right,c)),l=Math.max(d.top,Math.min(d.bottom,l));let f=i.getAttribute(`transform`),p=``,m=f.match(/(rotate\([^)]+\))/);m&&(p=` `+m[1]),i.setAttribute(`transform`,`translate(${c}, ${l})${p}`)}function d(e){let t=e.getAttribute(`transform`)||`translate(0, 0)`,n=0,r=0,i=0,a=t.match(/translate\(([^,]+),\s*([^)]+)\)/);a&&(n=parseFloat(a[1]),r=parseFloat(a[2]));let o=t.match(/rotate\(([^,)]+)/);o&&(i=parseFloat(o[1]));let s=(i+45)%360;e.setAttribute(`transform`,`translate(${n}, ${r}) rotate(${s})`)}function p(){i&&(i.classList.remove(`dragging`),i=null,document.removeEventListener(`mousemove`,l),document.removeEventListener(`mouseup`,p),document.removeEventListener(`touchmove`,u),document.removeEventListener(`touchend`,p))}function m(){let t=[{x:10,y:10},{x:70,y:10},{x:10,y:70},{x:100,y:70},{x:140,y:70},{x:10,y:120},{x:70,y:120}];e.forEach((e,n)=>{e.setAttribute(`transform`,`translate(${t[n].x}, ${t[n].y})`)}),typeof j==`function`&&j()===`game`&&typeof f==`function`&&f()}let h=document.getElementById(`reset-btn`);h&&h.addEventListener(`click`,m),t()}function t(){let e=document.querySelectorAll(`.shape-btn`);e.length&&(e.forEach(t=>{t.addEventListener(`click`,function(){let t=this.dataset.shape;if(typeof d==`function`){d(t),e.forEach(e=>e.classList.remove(`active`)),this.classList.add(`active`);let n=document.getElementById(`reset-btn`);n&&n.click(),typeof j==`function`&&j()===`game`&&typeof f==`function`&&f()}})}),e[0]&&e[0].classList.add(`active`))}});var M={POSITION:8,ROTATION:5},N={BIG_TRIANGLE:`big-triangle`,MEDIUM_TRIANGLE:`medium-triangle`,SMALL_TRIANGLE:`small-triangle`,SQUARE:`square`,PARALLELOGRAM:`parallelogram`},P=[[N.BIG_TRIANGLE,N.BIG_TRIANGLE],[N.SMALL_TRIANGLE,N.SMALL_TRIANGLE]];function F(){let e=document.querySelectorAll(`.tangram-piece`),t=[];return e.forEach(e=>{let n=e.getAttribute(`transform`)||`translate(0,0)`,r=0,i=0,a=0,o=n.match(/translate\(([^,]+),\s*([^)]+)\)/);o&&(r=parseFloat(o[1]),i=parseFloat(o[2]));let s=n.match(/rotate\(([^,)]+)/);s&&(a=parseFloat(s[1])),a=(a%360+360)%360,t.push({element:e,type:e.dataset.shape,x:Math.round(r*100)/100,y:Math.round(i*100)/100,angle:Math.round(a*100)/100,id:e.id})}),t}function I(e){return(e%360+360)%360}function L(e,t){let n=I(e),r=I(t),i=Math.round(n/45)*45,a=Math.round(r/45)*45;return Math.abs(i-a)<.01}function R(e,t,n,r,i=M.POSITION){let a=Math.abs(e-n),o=Math.abs(t-r);return a<=i&&o<=i}function z(e,t){for(let n of P)if(n.includes(e)&&n.includes(t))return!0;return!1}function B(e){if(!e||!e.pieces)return!1;let t=F(),n=[...e.pieces];document.querySelectorAll(`.tangram-piece`).forEach(e=>{e.classList.remove(`correct`,`incorrect`)});let r=[],i=!0;for(let e of n){let n=!1;for(let i=0;i<t.length;i++){let a=t[i];if(!(a.type===e.type||z(a.type,e.type)))continue;let o=R(a.x,a.y,e.x,e.y),s=L(a.angle,e.angle);if(o&&s){a.element.classList.add(`correct`),r.push({target:e,current:a,perfect:!0}),t.splice(i,1),n=!0;break}}n||(i=!1)}return t.length>0&&(i=!1),{success:i,matched:r.length,total:n.length}}function V(){if(typeof u!=`function`)return!1;let e=u();return e?B(e):!1}function H(){let e=document.getElementById(`check-btn`);e&&e.addEventListener(`click`,function(){let e=V(),t=document.getElementById(`check-message`);t&&t.remove();let n=document.createElement(`div`);n.id=`check-message`,e.success?(n.textContent=`Фигура собрана!`,n.className=`success`):(n.textContent=`Совпало фигур: ${e.matched}/${e.total}`,n.className=`info`),document.body.appendChild(n),setTimeout(()=>{n.parentNode&&n.remove()},3e3)})}document.addEventListener(`DOMContentLoaded`,function(){setTimeout(H,1e3)});